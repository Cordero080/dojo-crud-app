<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head') %>
  </head>
  <body class="page-edit">
    <%- include('../partials/nav') %>

    <% /* Prev/Next only when provided by the route */ %>
    <% if (typeof prevId !== 'undefined' && prevId) { %>
      <a id="nav-prev" class="nav-arrow nav-prev"
         href="/forms/<%= prevId %>/edit"
         aria-label="Previous form"
         title="Previous form">&lsaquo;</a>
    <% } %>
    <% if (typeof nextId !== 'undefined' && nextId) { %>
      <a id="nav-next" class="nav-arrow nav-next"
         href="/forms/<%= nextId %>/edit"
         aria-label="Next form"
         title="Next form">&rsaquo;</a>
    <% } %>

    <h1><%= title %></h1>

    <% if (typeof error !== 'undefined' && error) { %>
      <p class="error"><%= error %></p>
    <% } %>

    <% if (!form) { %>
      <p class="error">Form not found.</p>
      <%- include('../partials/footer') %>
    </body>
</html>
    <% } else { %>
    <div class="edit-form-center">
      <form action="/forms/<%= form._id %>?_method=PUT" method="POST" autocomplete="off">
        <label for="name">Form Name:</label>
        <input id="name" name="name" required value="<%= form.name %>"/>
        <% if (errors && errors.name) { %><small class="error"><%= errors.name %></small><% } %>

        <label for="rankType">Rank Type:</label>
        <select id="rankType" name="rankType" required>
          <option value="Kyu" <%= form.rankType==='Kyu' ? 'selected' : '' %>>Kyu/Level</option>
          <option value="Dan" <%= form.rankType==='Dan' ? 'selected' : '' %>>Dan/Degree</option>
        </select>
        <% if (errors && errors.rankType) { %><small class="error"><%= errors.rankType %></small><% } %>

        <label for="rankNumber">Rank Number:</label>
        <input id="rankNumber" name="rankNumber" type="number" min="1" required value="<%= form.rankNumber %>"/>
        <% if (errors && errors.rankNumber) { %><small class="error"><%= errors.rankNumber %></small><% } %>

        <label for="beltColor">Belt Color:</label>
        <input id="beltColor" name="beltColor" value="<%= form.beltColor || '' %>"/>

        <label for="category">Category:</label>
        <select id="category" name="category">
          <option value="Kata"   <%= form.category==='Kata'   ? 'selected' : '' %>>Kata</option>
          <option value="Bunkai" <%= form.category==='Bunkai' ? 'selected' : '' %>>Bunkai</option>
          <option value="Kumite" <%= form.category==='Kumite' ? 'selected' : '' %>>Kumite</option>
          <option value="Weapon" <%= form.category==='Weapon' ? 'selected' : '' %>>Weapon</option>
          <option value="Other"  <%= form.category==='Other'  ? 'selected' : '' %>>Other</option>
        </select>
        <% if (errors && errors.category) { %><small class="error"><%= errors.category %></small><% } %>

        <label for="description-edit">Description:</label>
        <textarea id="description-edit" name="description"><%= form.description || '' %></textarea>

        <label for="referenceUrl">Reference URL:</label>
        <input id="referenceUrl" name="referenceUrl" type="url" value="<%= form.referenceUrl || '' %>"/>
        <% if (errors && errors.referenceUrl) { %><small class="error"><%= errors.referenceUrl %></small><% } %>

        <label style="display:inline-flex;align-items:center;gap:8px;">
          <input type="checkbox" name="learned" class="futuristic-checkbox" <%= form.learned ? 'checked' : '' %> />
          <span>Learned</span>
        </label>

        <p>
          <a href="/forms/<%= form._id %>" class="view-form">
            <button type="button" class="create-form-btn">View Form</button>
          </a>
        </p>

        <button class="create-form-btn" type="submit">Save Changes</button>
      </form>
    </div>

    <%- include('../partials/footer') %>
  </body>
</html>
    <% } %>
